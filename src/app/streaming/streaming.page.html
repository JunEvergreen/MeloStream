<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/music-pmenu"></ion-back-button>
    </ion-buttons>
    <ion-title>Spotify Music</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="spotify-container">
    <!-- Error message with retry -->
    <ion-item *ngIf="error" color="danger" class="error-message">
      <ion-icon name="alert-circle" slot="start"></ion-icon>
      <ion-label class="ion-text-wrap">{{ error }}</ion-label>
      <ion-button slot="end" fill="clear" (click)="retry()">
        <ion-icon slot="icon-only" name="refresh"></ion-icon>
      </ion-button>
    </ion-item>

    <!-- New Releases -->
    <ion-list-header>
      <ion-label>New Releases</ion-label>
    </ion-list-header>
    
    <!-- New Releases Loading -->
    <div *ngIf="loading" class="loading-container">
      <ion-spinner name="circular"></ion-spinner>
      <p>Loading new releases...</p>
    </div>

    <!-- New Releases Content -->
    <ion-grid *ngIf="!loading && newReleases.length > 0">
      <ion-row>
        <ion-col size="6" *ngFor="let track of newReleases">
          <ion-card>
            <img [src]="track.album.images[0] && track.album.images[0].url" 
                 [alt]="track.name"
                 onerror="this.src='assets/default-album.png'">
            <ion-card-header>
              <ion-card-subtitle>{{track.artists[0] && track.artists[0].name || 'Unknown Artist'}}</ion-card-subtitle>
              <ion-card-title>{{track.name}}</ion-card-title>
            </ion-card-header>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>

    <!-- Featured Playlists -->
    <ion-list-header>
      <ion-label>Featured Playlists</ion-label>
    </ion-list-header>

    <!-- Playlists Loading -->
    <div *ngIf="playlistsLoading" class="loading-container">
      <ion-spinner name="circular"></ion-spinner>
      <p>Loading playlists...</p>
    </div>

    <!-- Playlists Content -->
    <ion-grid *ngIf="!playlistsLoading && featuredPlaylists.length > 0">
      <ion-row>
        <ion-col size="6" *ngFor="let playlist of featuredPlaylists">
          <ion-card>
            <img [src]="playlist.images[0] && playlist.images[0].url" 
                 [alt]="playlist.name"
                 onerror="this.src='assets/default-playlist.png'">
            <ion-card-header>
              <ion-card-title>{{playlist.name}}</ion-card-title>
              <ion-card-subtitle>{{playlist.tracks?.total || 0}} tracks</ion-card-subtitle>
            </ion-card-header>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>

    <!-- No Content Message -->
    <div *ngIf="!loading && !playlistsLoading && newReleases.length === 0 && featuredPlaylists.length === 0 && !error" 
         class="center-wrapper">
      <div id="empty-state">
        <ion-icon name="musical-notes-outline" size="large"></ion-icon>
        <h2>No Content Available</h2>
        <p class="scan-text" (click)="retry()">Try Again</p>
      </div>
    </div>
  </div>
</ion-content>

<ion-footer>
  <ion-tab-bar slot="bottom">
    <ion-tab-button [routerLink]="['/music-pmenu']" routerDirection="root">
      <ion-icon name="musical-note-outline"></ion-icon>
      <ion-label>Music</ion-label>
    </ion-tab-button>

    <ion-tab-button [routerLink]="['/streaming']" routerDirection="root">
      <ion-icon name="cloud-outline"></ion-icon>
      <ion-label>Streaming</ion-label>
    </ion-tab-button>
  </ion-tab-bar>
</ion-footer>
